--!strict
--[[ Module Info:
	Original Author: Sceleratis/Davey_Bones
	Improved by: EgizianoEG
	Description: This plugin will whitelist only certain commands for use, and set the rest as Creators-only
	
	Place this ModuleScript in Adonis_Loader > Config > Plugins and name it either "Server-Command_Restrictor" or "Server: Command_Restrictor"
--]]
--[[ More Info:
	Command indexes to not restrict go into the whitelist table below
	If the value is false, it will use the command's original (default) AdminLevel
	If the value is set to a Permission type (rank name or level), it will use that as the new AdminLevel
	Any commands not in the below table will be set as Creators (Level 900+) only
]]
-------------------------------------------------------|

type Permission = string|number|boolean|{string|number}

local Whited_Listed_Commands: {[string]: Permission} = {
	
	-- Format:
	-- [CMD_NAME_OR_INDEX] = ADMIN_RANK_NAME | ADMIN_LEVEL | false | {ADMIN_RANK_NAME | ADMIN_LEVEL}
	
	--| Player+ Commands:
	cape		= false,
	capes		= false,
	uncape		= false,
	countdown 	= false,
	ap			= "Players",
	cmds		= "Players",
	join		= "Players",
	ping		= "Players",
	pnum		= "Players",
	rand		= "Players",
	theme		= "Players",
	paint		= "Players",
	quote		= "Players",
	client		= "Players",
	invite		= "Players",
	rejoin		= "Players",
	aliases		= "Players",
	notepad		= "Players",
	notifyme	= "Players",
	keybinds	= "Players",
	timedate	= "Players",
	addfriend	= "Players",
	countries	= "Players",
	devconsole	= "Players",
	joinfriend	= "Players",
	blockedusers	= "Players",
	uninspiration	= "Players",
	onlinefriends	= "Players",
	inspectavatar	= "Players",

	-------------------------
	--| Moderators+ Commands:
	h			= "Moderators",
	m 			= "Moderators",
	cm			= "Moderators",
	pm			= "Moderators",
	tm			= "Moderators",
	th			= "Moderators",
	To 			= "Moderators",
	tp 			= "Moderators",
	to 			= "Moderators",
	rv			= "Moderators",
	npm			= "Moderators",
	mpm			= "Moderators",
	afk			= "Moderators",
	ban			= "Moderators",
	esp			= "Moderators",
	sit			= "Moderators",
	heal		= "Moderators",
	stun		= "Moderators",
	tell		= "Moderators",
	kick 		= "Moderators",
	team 		= "Moderators",
	note 		= "Moderators",
	view 		= "Moderators",
	logs 		= "Moderators",
	mute 		= "Moderators",
	info 		= "Moderators",
	usage		= "Moderators",
	unban		= "Moderators",
	slock		= "Moderators",
	teams		= "Moderators",
	tools		= "Moderators",
	unesp		= "Moderators",
	track 		= "Moderators",
	clear 		= "Moderators",
	notes		= "Moderators",
	bring		= "Moderators",
	unblur		= "Moderators",
	unmute		= "Moderators",
	unview		= "Moderators",
	unstun		= "Moderators",
	myhats		= "Moderators",
	unteam		= "Moderators",
	donors		= "Moderators",
	cmdbox 		= "Moderators",
	refresh		= "Moderators",
	players 	= "Moderators",
	profile		= "Moderators",
	mutelist	= "Moderators",
	['warn']	= "Moderators",
	warnings	= "Moderators",
	newteam		= "Moderators",
	untrack		= "Moderators",
	viewcam		= "Moderators",
	kickwarn 	= "Moderators",
	joinlogs 	= "Moderators",
	chatlogs 	= "Moderators",
	showlogs 	= "Moderators",
	leavelogs	= "Moderators",
	locallogs	= "Moderators",
	rbxnotify	= "Moderators",
	showtools	= "Moderators",
	hcountdown	= "Moderators",
	chatnotify	= "Moderators",
	serverlist	= "Moderators",
	removeteam	= "Moderators",
	removenote 	= "Moderators",
	removenotes = "Moderators",
	countdownpm = "Moderators",
	exploitlogs	= "Moderators",
	privatechat	= "Moderators",
	cleareffects = "Moderators",
	notifications = "Moderators",
	removewarning = "Moderators",
	clearwarnings = "Moderators",
	stopcountdown = "Moderators",
	clearadonisguis = "Moderators",
	
	--| Fun Commands Allowed:
	rope		= "Moderators",
	gear		= "Moderators",
	blur		= "Moderators",
	unrope		= "Moderators",
	glitch		= "Moderators",
	unglitch	= "Moderators",
	uneffect	= "Moderators",
	
	---------------------
	--| Admins+ Commadns:
	sn			= "Admins",
	sm			= "Admins",
	vote		= "Admins",
	jump 		= "Admins",
	shirt 		= "Admins",
	pants 		= "Admins",
	bchat 		= "Admins",
	unchat 		= "Admins",
	jpower		= "Admins",
	admins 		= "Admins",
	notify 		= "Admins",
	unname 		= "Admins",
	cmdinfo		= "Admins",
	cameras		= "Admins",
	guiview		= "Admins",
	jheight		= "Admins",
	oldlogs		= "Admins",
	shutdown 	= "Admins",
	unguiview	= "Admins",
	resetview	= "Admins",
	setmessage	= "Admins",
	shutdownlogs = "Admins",
	softshutdown = "Admins",
	getgroupinfo = "Admins",
	
	--| Music Permissions:
	music		= "Admins",
	pause		= "Admins",
	resume		= "Admins",
	musiclist	= "Admins",
	stopmusic	= "Admins",
	
	--| Fun Commands Allowed:
	cut			= "Admins",
	dance		= "Admins",
	smoke		= "Admins",
	unsmoke		= "Admins",
	
	-------------------------
	--| HeadAdmins+ Commands:
	fly 		= "HeadAdmins",
	fix			= "HeadAdmins",
	give		= "HeadAdmins",
	sudo		= "HeadAdmins",
	clip 		= "HeadAdmins",
	kill 		= "HeadAdmins",
	alert		= "HeadAdmins",
	admin		= "HeadAdmins",
	unfly 		= "HeadAdmins",
	freeze		= "HeadAdmins",
	health		= "HeadAdmins",
	noclip 		= "HeadAdmins",
	tempmod		= "HeadAdmins",
	gameban 	= "HeadAdmins",
	banlist		= "HeadAdmins",
	respawn 	= "HeadAdmins",
	visible 	= "HeadAdmins",
	permban		= "HeadAdmins",
	tempban		= "HeadAdmins",
	freecam		= "HeadAdmins",
	unadmin		= "HeadAdmins",
	permmod		= "HeadAdmins",
	slowmode	= "HeadAdmins",
	flyspeed	= "HeadAdmins",
	trelloban	= "HeadAdmins",
	backupmap	= "HeadAdmins",
	broadcast	= "HeadAdmins",
	perfstats	= "HeadAdmins",
	unfreecam	= "HeadAdmins",
	errorlogs	= "HeadAdmins",
	invisible 	= "HeadAdmins",
	flynoclip 	= "HeadAdmins",
	ungameban 	= "HeadAdmins",
	untimeban 	= "HeadAdmins",
	removetool	= "HeadAdmins",
	serverinfo	= "HeadAdmins",
	restoremap	= "HeadAdmins",
	serverspeed	= "HeadAdmins",
	timebanlist = "HeadAdmins",
	removetools = "HeadAdmins",
	crossserver = "HeadAdmins",
	tempunadmin	= "HeadAdmins",
	adonisalerts = "HeadAdmins",
	privateservers = "HeadAdmins",
	crossservervote = "HeadAdmins",
	fixplayerlighting = "HeadAdmins",

	---------------------------------
	--[[ All Available Fun Commands:

	ice			=	"Permission",
	dog			=	"Permission",		-- [R6 Characters only]
	wat			=	"Permission",		-- [Player Perfix] / [Hidden Command]
	mat			=	"Permission",		-- [Shows you materials; Same as ":materials"]
	cut			=	"Permission",		-- [Cuts and make the player bleed]
	nuke		=	"Permission",		-- [As it says, nukes player]
	spin		=	"Permission",		-- [Spins the character]
	neon		=	"Permission",		-- [Make the target neon]
	dogg		=	"Permission",		-- [Turns the target into the one and only D O Double G]
	talk		=	"Permission",		-- [Makes a dialog bubble appear over the target player(s) head with the desired message]
	grav		=	"Permission",		-- [Restores the original experience gravity]
	rope		=	"Permission",		-- [Connects players using a rope constraint]
	nyan		=	"Permission",		-- [Poptart kitty texture instead of the character]
	sh1a		=	"Permission",		-- [sh1a]
	gear		=	"Permission",		-- [Gives the target player(s) a gear from the catalog based on the ID you supply]
	trip		=	"Permission",		-- [Rotates the target player(s) by 180 degrees or a custom angle]
	maze		=	"Permission",		-- [Sends player to The Maze for a timeout | External Teleport]
	blur		=	"Permission",		-- [Blurs the target player's screen with the blur size you provide]
	fr0g		=	"Permission",		-- [Turns the target player's character into frog texture]
	puke		=	"Permission",		-- [Make the target player(s) puke (Not cool.)]
	hole		=	"Permission",		-- [Sends the target player(s) down a hole]
	fire		=	"Permission",		-- [Sets the target player(s) on fire, coloring the fire based on what you set]
	pets		=	"Permission",		-- [Makes your hat pets do the specified command (follow/float/swarm/attack)]
	smoke		=	"Permission",		-- [Makes smoke come from the target player(s) with the desired color; Same as ":givesmoke"]
	shrek		=	"Permission",		-- [Shrekify the target player(s)]
	ggrav		=	"Permission",		-- [Sets the Workspace.Gravity]
	disco		=	"Permission",		-- [Turns the place into a disco party!]
	dance		=	"Permission",		-- [Make the target player(s) dance]
	spook		=	"Permission",		-- [Turns the target player(s) screen spooky. Not recommended]
	dizzy		=	"Permission",		-- [Causes motion sickness and the target player(s) screen keeps rotating]
	bloom		=	"Permission",		-- [Give the player's screen the bloom lighting effect]
	k1tty		=	"Permission",		-- [Kitty 2D moving  texture instead of the targeted player(s) character]
	trail		=	"Permission",		-- [Adds trails to the target's character's parts]
	blind		=	"Permission",		-- [Turns the target player(s) screen into black]
	clown		=	"Permission",		-- [Targetted player(s) will be kidnapped by clowns. External Teleport.]
	poison		=	"Permission",		-- [Slowly kills the target player(s)]
	resize		=	"Permission",		-- [Resize the target player(s)'s character by <mult>]
	sp00ky		=	"Permission",		-- [Turns the targetted player(s) character into a moving 2D skeleton]
	rocket		=	"Permission",		-- [Sends the targetted player(s) to the Moon!]
	infect		=	"Permission",		-- [Turn the target player(s) into a suit zombie]
	sticky		=	"Permission",		-- [Makes the targetted player(s) sticky and stick to any part]
	glitch		=	"Permission",		-- [Glitch effect. Local Only.]
	unspin		=	"Permission",		-- [Opposite of command ":spin"]
	unrope		=	"Permission",		-- [Removes the rope constraint made by command ":rope"]
	brazil		=	"Permission",		-- [YOU ARE GOING TO BRAZIL!]
	freaky		=	"Permission",		-- [Does freaky stuff to lighting. Like a messed up ambient.]
	forest		=	"Permission",		-- [Sends player to The Forest for a timeout. External Place Teleport!]
	thanos		=	"Permission",		-- [Makes the targetted player(s) disappear and then kicks them]
	nograv		=	"Permission",		-- [NoGrav the target player(s)]
	setfps		=	"Permission",		-- [Sets the target players's FPS]
	lowres		=	"Permission",		-- [Pixelizes the player's view]
	gerald		=	"Permission",		-- [A massive Gerald AloeVera hat.]
	chik3n		=	"Permission",		-- [Call on the KFC dark prophet powers of chicken]
	shiney		=	"Permission",		-- [Make the target player(s)'s character shiney]
	unfire		=	"Permission",		-- [Opposite of command ":fire"]
	bodyswap	=	"Permission",		-- [Swaps player1's and player2's avatars, bodies and tools]
	bighead		=	"Permission",		-- [Gives the target player(s) a larger ego]
	particle	=	"Permission",		-- [Puts custom particle emitter on target]
	trolled		=	"Permission",		-- [Not Recommended.]
	skeleton	=	"Permission",		-- [Turn the target player(s) into a skeleton]
	loadsky		=	"Permission",		-- [Change the skybox with the provided image IDs]
	chargear	=	"Permission",		-- [Gives you a doll of a player]
	undizzy		=	"Permission",		-- [Opposite of command ":dizzy"]
	setgrav		=	"Permission",		-- [Set the target player(s)'s gravity]
	creeper		=	"Permission",		-- [Turn the target player(s) into a creeper]
	thermal		=	"Permission",		-- [Changes the targetted player(s) screen into thermal vision view]
	bunnyhop	=	"Permission",		-- [akes the player jump, and jump... and jump. Just like the rabbit noobs you find in sf games.]
	zawarudo	=	"Permission",		-- [Freezes everything but the player running the command]
	explode		=	"Permission",		-- [Explodes the target player(s)]
	sunrays		=	"Permission",		-- [Give the player's screen the sunrays lighting effect]
	slippery	=	"Permission",		-- [Makes the target player(s) slide when they walk]
	boombox		=	"Permission",		-- [Gives the target player(s) a boombox]
	ungerald	=	"Permission",		-- [De-Geraldification. Opposite of ":gerald"]
	iloveyou	=	"Permission",		-- [Not Recommended]
	ghostify	=	"Permission",		-- [Turn the target player(s) into a ghost]
	headlian	=	"Permission",		-- [Something weird.]
	flatten		=	"Permission",		-- [Makes the targetted player(s) like a 2D texture]
	vibrate		=	"Permission",		-- [Kinda like gd, but teleports the player to four points instead of two]
	goldify		=	"Permission",		-- [Turns the character into a golden one!]
	swagify		=	"Permission",		-- [Swag the target player(s) up]
	freefall	=	"Permission",		-- [Teleport the target player(s) up by <height> studs]
	sparkles	=	"Permission",		-- [Puts sparkles on the target player(s) with the desired color]
	noobify		=	"Permission",		-- [Make the target player(s) look like a noob]
	hatpets		=	"Permission",		-- [Gives the target player(s) hat pets.]
	seizure		=	"Permission",		-- [Make the target player(s)'s character spazz out on the floor]
	uneffect	=	"Permission",		-- [Removes any effect GUIs on the target player(s)]
	tornado		=	"Permission",		-- [Makes a tornado on the target player(s)]
	wildfire	=	"Permission",		-- [Starts a fire at the target player(s); Ignores locked parts and parts named 'BasePlate' or 'Baseplate']
	theycome	=	"Permission",		-- [Not Recommended]
	unsmoke		=	"Permission",		-- [Removes any smoke from the targetted player(s) character]
	oddliest	=	"Permission",		-- [Turns you into the one and only Oddliest]
	trigger		=	"Permission",		-- [Makes the target player really angry]
	unglitch	=	"Permission",		-- [Opposite of command ":glitch"]
	stickify	=	"Permission",		-- [Turns the target player(s) into a stick figure]
	loopfling	=	"Permission",		-- [Loop flings the target player(s)]
	deadlands	=	"Permission",		-- [The edge of Roblox math; WARNING CAPES CAN CAUSE LAG]
	unseizure	=	"Permission",		-- [Removes the effects of the seizure command]
	unthermal	=	"Permission",		-- [Removes thermal vision; Opposite for ":thermal"]
	['break']	=	"Permission",		-- [Break the target player(s)]
	animation	=	"Permission",		-- [Load the animation onto the target]
	lightning	=	"Permission",		-- [Zeus strikes down the target player(s)]
	smallhead	=	"Permission",		-- [Give the target player(s) a small head]
	unbunnyhop	=	"Permission",		-- [Stops the forced hippity hoppening]
	playergear	=	"Permission",		-- [Turns the target player into a doll which can be picked up]
	rainbowify	=	"Permission",		-- [Make the target player(s)'s character flash random colors]
	unparticle	=	"Permission",		-- [Removes particle emitters from target]
	unsparkles	=	"Permission",		-- [Removes sparkles from the target player(s)]
	breakdance	=	"Permission",		-- [Make the target player(s) break dance]
	unslippery	=	"Permission",		-- [Get sum friction all up in yo step; Opposite of command ":slippery"]
	oldflatten	=	"Permission",		-- [Old Flatten. Went lazy on this one.]
	restorefps	=	"Permission",		-- [Restores the target players's FPS]
	sceleratis	=	"Permission",		-- [Turns the targetted player(s) into this charactar avatar]
	undeadlands	=	"Permission",		-- [Clips the player and teleports them to you]
	startergear	=	"Permission",		-- [Inserts the desired gear into the target player(s)'s starter gear]
	oldbodyswap	=	"Permission",		-- [[Old] Swaps player1's and player2's bodies and tools]
	Davey_Bones	=	"Permission",		-- [Turns the targetted player(s) character into Davey_Bones' one]
	removelimbs	=	"Permission",		-- [Remove the target player(s)'s arms and legs]
	screenimage	=	"Permission",		-- [Places the desired image on the target's screen]
	screenvideo	=	"Permission",		-- [Places the desired video on the target's screen]
	unloopfling	=	"Permission",		-- [Ends command ":loopfling"]
	ghostglitch	=	"Permission",		-- [The same as gd but less trippy, teleports the target player(s) back and forth in the same direction, making two ghost like images of the game]
	stopwildfire =	"Permission",		-- [Stops the command ":wildfire" and stops fire from spreading further]
	colorcorrect =	"Permission",		-- [Give the player's screen the sunrays lighting effect]
	runanimation =	"Permission",		-- [Change the target player(s)'s run animation, based on the default animation system. Supports 'R15' as animationID argument to use default rig animation.]
	jumpanimation =	"Permission",		-- [Change the target player(s)'s jump animation, based on the default animation system. Supports 'R15' as animationID argument to use default rig animation.]
	fallanimation =	"Permission",		-- [Change the target player(s)'s fall animation, based on the default animation system. Supports 'R15' as animationID argument to use default rig animation.]
	walkanimation = "Permission",		-- [Change the target player(s)'s walk animation, based on the default animation system. Supports 'R15' and 'R6' as animationID argument to use default rig animation.]
	createsoundpart	= "Permission",		-- [Creates a sound part]
]]
}

return function(Vargs)
	
	local server = Vargs.Server
	local service = Vargs.Service
	
	-- Setting  the permissions:
	for ind, cmd in pairs(server.Commands) do
		local whitelistPerm = Whited_Listed_Commands[ind:lower()]
		if whitelistPerm == nil then
			for _, v in ipairs(cmd.Commands) do
				whitelistPerm = Whited_Listed_Commands[v:lower()]
				if whitelistPerm ~= nil then
					break
				end
			end
		end
		
		if whitelistPerm ~= nil then
			if whitelistPerm then
				cmd.AdminLevel = whitelistPerm
			end
		else
			cmd.AdminLevel = 900
		end
	end
	
	-- Unhide some player commands from the cmd list:
	for ind, cmd in pairs(server.Commands) do
		if cmd.Commands[1] == "theme" or cmd.Commands[1] == "countries" or 
			cmd.Commands[1] == "addfriend" or cmd.Commands[1] == "notifyme" then
			cmd.Hidden = false
		end
	end
end
